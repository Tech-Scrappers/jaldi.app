import{_ as N}from"./Dropzone.vue_vue_type_script_setup_true_lang-CflmKFQW.js";import{d as U,Q as V,R as A,r as a,A as I,a4 as L,c as d,a as t,t as n,b as s,w as l,u as o,F as h,h as b,Y as M,a9 as T,x as v,o as c,_ as R,e as z,Z as O,f as x,D as S,a1 as W,aa as $}from"./index-iXE1tgq1.js";import"./dropzone-DWIWGpu4.js";const q={class:"grid grid-cols-12 gap-6 mt-5"},J={class:"col-span-12 intro-y lg:col-span-12"},K={class:"flex flex-col items-center p-5 border-b sm:flex-row border-slate-200/60 dark:border-darkmode-400"},P={class:"mr-auto text-base font-semibold"},Q={class:"w-full flex justify-between intro-y px-5"},X={class:"p-5 bg-white shadow-md rounded-lg w-[800px] mx-auto mt-2 upload-detail"},Y={class:"flex justify-center py-8"},Z={class:"text-lg font-medium"},G={key:0,class:"mt-4 pl-4"},H={class:"p-5 text-center"},ee={class:"mt-5 text-3xl"},te={class:"mt-2 text-slate-500"},oe={class:"px-5 pb-8 text-center"},se={class:"ml-4 mr-4"},ne={class:"font-medium"},ae={class:"mt-1 text-slate-500"},ue=U({__name:"import",setup(le){const j=V().getUserId;A(new T);const g=a(),F=a(),C=a(),u=a(!1),k=a(!1),y=a(null),D=()=>{u.value=!1},B=()=>{$.push("/inventory/stock-adjustment"),k.value=!1,u.value=!1,console.log($.push("/inventory/stock-adjustment"))};v("bind[dropzoneSingleRef]",e=>{g.value=e}),v("bind[dropzoneMultipleRef]",e=>{F.value=e}),v("bind[dropzoneValidationRef]",e=>{C.value=e});const w=j;I(()=>{const e=g.value;e&&(e.dropzone.options.init=function(){this.on("sending",function(m,p,i){i.append("user_id",w)})},e.dropzone.on("success",()=>{u.value=!0}),e.dropzone.on("error",()=>{k.value=!0;const m=document.querySelectorAll("#failed-notification-content")[0].cloneNode(!0);m.classList.remove("hidden"),L({node:m,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast()}))});const E=localStorage.getItem("token")||"",f=a("");return(e,m)=>(c(),d(h,null,[t("div",q,[t("div",J,[t("div",K,[t("h2",P,n(e.$t("stock-adjustment.ImportFile")),1)]),t("div",Q,[t("div",null,[s(o(O),{to:"/inventory/stock-adjustment"},{default:l(()=>[s(o(R),{variant:"primary",class:"mr-2 shadow-md"},{default:l(()=>[z(n(e.$t("common.Back")),1)]),_:1})]),_:1})])]),t("div",X,[s(o(N),{refKey:"dropzoneSingleRef",options:{url:"https://inventory.jaldi.app/api/v1/stock-adjustments/import",thumbnailWidth:150,maxFilesize:.5,maxFiles:1,addRemoveLinks:!0,acceptedFiles:".xls,.xlsx",headers:{Authorization:`Bearer ${o(E)}`},init(){this.on("sending",(p,i,r)=>{r.append("user_id",o(w))}),this.on("error",(p,i,r)=>{if(r){const _=JSON.parse(r.responseText);f.value=_.errors}else console.error(i)})}},class:"dropzone"},{default:l(()=>[t("div",Y,[s(o(x),{icon:"Upload",class:"w-10 h-10"})]),t("div",Z,n(e.$t("stock-adjustment.Dropfileupload")),1)]),_:1},8,["options"]),f.value?(c(),d("div",G,[(c(!0),d(h,null,b(f.value,(p,i)=>(c(),d("ul",{class:"list-disc text-sm mb-0.5 text-red-600",key:i},[(c(!0),d(h,null,b(p,(r,_)=>(c(),d("li",{key:_},n(r),1))),128))]))),128))])):M("",!0)])])]),s(o(S),{open:u.value,onClose:D,initialFocus:y.value},{default:l(()=>[s(o(S).Panel,null,{default:l(()=>[t("div",H,[s(o(x),{icon:"BadgeCheck",class:"w-16 h-16 mx-auto mt-3 text-green-500"}),t("div",ee,n(e.$t("stock-adjustment.FileUpdatesuccessful")),1),t("div",te,n(e.$t("stock-adjustment.Effortlesslyupload")),1)]),t("div",oe,[s(o(R),{variant:"success",type:"button",class:"w-24 ml-4 text-white",ref_key:"deleteButtonRef",ref:y,onClick:B},{default:l(()=>[z(n(e.$t("common.ok")),1)]),_:1},512)])]),_:1})]),_:1},8,["open","initialFocus"]),s(o(W),{id:"failed-notification-content",class:"flex hidden"},{default:l(()=>[s(o(x),{icon:"XCircle",class:"text-danger"}),t("div",se,[t("div",ne,n(e.$t("common.Nomorefilesplease")),1),t("div",ae,n(e.$t("common.AlreadyUploaddata")),1)])]),_:1})],64))}});export{ue as default};
