import{d as j,r as c,U as se,V as P,i as S,w as f,u as n,o as p,a,e as _,c as y,b as o,f as x,Y as U,$ as le,O as ne,ae as O,g as J,t as v,R as T,A as Y,a9 as oe,n as Q,_ as D,a0 as W,F as q,D as N,a2 as R,a3 as F,a5 as X,Q as re,W as ie,a1 as ce,ag as z,ah as L}from"./index-Do1w1vvF.js";const de={class:"flex w-[80px]",id:"fix"},ue=["onClick"],me=["checked"],ve={class:"flex gap-2.5"},fe=["onClick"],pe=["onClick"],he=j({__name:"BrandTable",props:{isloading:Boolean,totalRows:Number,params:Object,changeServer:Function,data:{type:Array,required:!0}},setup(i){c([]);const{t:g}=se(),u=c([{field:"name",title:g("brand.name")},{field:"product_count",title:g("brand.linkedProducts")},{field:"is_active",title:g("brand.status"),sort:!1},{field:"actions",title:g("brand.actions"),sort:!1}]),h=P();return(r,t)=>(p(),S(n(le),{ref:"datatable",columns:u.value,rows:i.data,loading:i.isloading,totalRows:i.totalRows,isServerMode:!0,pageSize:i.params.limit,sortable:!0,sort:i.params.sort,sortDirection:i.params.sort_direction,search:i.params.search,onChange:i.changeServer},{is_active:f(s=>[a("div",de,[a("label",{class:"switch",onClick:m=>r.$emit("toggleActive",s.value)},[a("input",{type:"checkbox",checked:s.value.is_active},null,8,me),t[0]||(t[0]=_()),t[1]||(t[1]=a("span",{class:"slider round"},null,-1))],8,ue)])]),actions:f(s=>[a("div",ve,[n(h).can("delete","brand")?(p(),y("a",{key:0,href:"#",class:"bg-red-100 p-2 rounded-md",onClick:m=>r.$emit("deleteUser",s.value.id)},[o(n(x),{icon:"Trash2",class:"w-4 h-4 text-[#cf2c47]"})],8,fe)):U("",!0),t[2]||(t[2]=_()),n(h).can("edit","brand")?(p(),y("a",{key:1,href:"#",class:"bg-blue-100 p-2 rounded-md cursor-pointer",onClick:m=>r.$emit("editUser",s.value)},[o(n(x),{icon:"PencilLine",class:"w-4 h-4 text-blue-500"})],8,pe)):U("",!0)])]),_:1},8,["columns","rows","loading","totalRows","pageSize","sort","sortDirection","search","onChange"]))}}),be=ne(he,[["__scopeId","data-v-7e34bea1"]]),ge={class:"mt-5 space-y-2"},_e={key:0,class:"mt-2 text-sm text-red-600"},ye=j({__name:"BrandForm",props:{initialBrand:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["update:brand"],setup(i,{emit:g}){const u=i,h=g,r=c({...u.initialBrand});return O(()=>u.initialBrand,t=>{r.value={...t}},{immediate:!0,deep:!0}),O(r,t=>{JSON.stringify(t)!==JSON.stringify(u.initialBrand)&&h("update:brand",t)},{deep:!0}),(t,s)=>(p(),y("div",ge,[s[1]||(s[1]=a("label",{class:"block text-sm font-medium text-slate-700"},"Name",-1)),o(J,{modelValue:r.value.name,"onUpdate:modelValue":s[0]||(s[0]=m=>r.value.name=m),type:"text",class:"mt-1 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm"},null,8,["modelValue"]),i.form.invalid("name")?(p(),y("div",_e,v(i.form.getError("name")),1)):U("",!0)]))}}),we={class:"p-5"},$e={class:"text-lg font-medium"},ke=j({__name:"BrandDialog",props:{showDialog:{type:Boolean,required:!0},editBrand:{type:Object,required:!0}},emits:["close","updated"],setup(i,{emit:g}){const u=i,h=g,r=c(u.showDialog),t=c({...u.editBrand}),s=c(!1);O(()=>u.showDialog,l=>{r.value!==l&&(r.value=l,t.value={...u.editBrand})});const m=()=>{console.log(s.value),s.value||(r.value=!1,h("close")),d.clear()},d=T(new oe),w=async()=>{try{s.value=!0;let l;t.value.id?l=await R.brand.update(t.value.id,t.value):l=await R.brand.create(t.value);const E=F(l);h("updated"),s.value=!1,m()}catch(l){d.setErrors(l.errors),X(l)}finally{s.value=!1}},$=l=>{t.value={...l}},k=c("en");return Y(()=>{k.value=localStorage.getItem("locale")||"en"}),(l,E)=>(p(),S(n(N),{open:r.value,onClose:m},{default:f(()=>[o(n(N).Panel,null,{default:f(()=>[a("div",we,[a("div",$e,v(t.value.isEdit?l.$t("brand.editBrand"):l.$t("brand.addNewBrand")),1),o(ye,{initialBrand:t.value,form:d,"onUpdate:brand":$},null,8,["initialBrand","form"]),a("div",{class:Q(["mt-6 flex gap-2",{"justify-end flex-row-reverse":k.value==="ar","justify-end":k.value!=="ar"}])},[o(n(D),{variant:"outline-secondary",type:"button",onClick:m,class:"w-24 mr-1",disabled:s.value},{default:f(()=>[_(v(l.$t("common.cancel")),1)]),_:1},8,["disabled"]),o(n(D),{variant:"primary",type:"button",class:"ml-4 w-24",onClick:w,disabled:s.value},{default:f(()=>[s.value?(p(),S(n(W),{key:0,icon:"three-dots",class:"w-5 h-5 text-white"})):(p(),y(q,{key:1},[_(v(t.value.isEdit?l.$t("common.update"):l.$t("common.create")),1)],64))]),_:1},8,["disabled"])],2)])]),_:1})]),_:1},8,["open"]))}}),Be={class:"mt-10 text-lg font-semibold intro-y"},Ce={class:"grid grid-cols-12 gap-6 mt-5 intro-y box p-8"},xe={class:"col-span-12 flex justify-between"},De={class:"relative w-56 text-slate-500 mr-3"},Se={class:"col-span-12"},Ee={class:"p-5 text-center"},Ue={class:"mt-5 text-3xl"},Ne={class:"mt-2 text-slate-500"},Re={class:"px-5 pb-8 text-center flex justify-center items-center"},je={class:"ml-4 mr-4"},Ve={class:"font-medium"},Ae={class:"mt-1 text-slate-500"},Oe=j({__name:"index",setup(i){const u=re().getUserId,h=c(!0),r=c(0),t=T({page:1,limit:10,search:"",sort:"",sort_direction:"asc",paginate:!0,column_filters:[]}),s=c([]),m=c(!1),d=T({id:null,name:"",is_active:!0,isEdit:!1}),w=c(!1),$=c(null),k=()=>{B()};let l,E;const G=()=>{clearTimeout(E),E=setTimeout(()=>{B()},300)},B=async()=>{try{l&&l.abort(),l=new AbortController;const e=l.signal;h.value=!0;const C=(await ie.get("https://inventory.jaldi.app/api/brands",{params:{...t,user_id:u,signal:e,product_count:1}})).data;s.value=C.data,r.value=C.meta.total}catch(e){console.error("Error fetching Stock Count:",e)}finally{h.value=!1}},H=e=>{t.page=e.current_page,t.limit=e.pagesize,t.sort=e.sort_direction==="desc"?`-${e.sort_column}`:`${e.sort_column}`,t.sort_direction=e.sort_direction,t.search=e.search,e.change_type==="search"?G():k()},V=c("en");Y(()=>{V.value=localStorage.getItem("locale")||"en",B()});const M=(e=null)=>{e?(d.isEdit=!0,d.id=e.id,d.name=e.name,d.is_active=e.is_active):(d.isEdit=!1,d.id=null,d.name="",d.is_active=!0),m.value=!0},K=async e=>{e.is_active=!e.is_active;try{const b=await R.brand.activation(e.id);F(b)}catch(b){e.is_active=!e.is_active,X(b)}},Z=e=>{$.value=e,w.value=!0},A=()=>{w.value=!1,$.value=null},ee=e=>{Z(e)},I=c(!1),te=async()=>{try{I.value=!0;const e=await R.brand.delete($.value);console.log("response",e),z().fry(L.brand.success(e.data.message)),F(e),A(),B()}catch(e){z().fry(L.brand.error(e.message)),w.value=!1}finally{I.value=!1}},ae=P();return(e,b)=>(p(),y(q,null,[a("h2",Be,v(e.$t("brand.brands")),1),a("div",Ce,[a("div",xe,[a("div",null,[n(ae).can("create","brand")?(p(),S(n(D),{key:0,variant:"primary",class:"mr-2 shadow-md",onClick:b[0]||(b[0]=()=>M(null))},{default:f(()=>[_(v(e.$t("brand.addNewBrand")),1)]),_:1})):U("",!0)]),a("div",{class:Q(["flex items-center mt-3 sm:mt-0",{"mr-auto":V.value==="ar","ml-auto":V.value!=="ar"}])},[a("div",De,[o(n(J),{modelValue:t.search,"onUpdate:modelValue":b[1]||(b[1]=C=>t.search=C),type:"text",class:"w-56 pr-10 !box",placeholder:e.$t("brand.labels.search")},null,8,["modelValue","placeholder"]),o(n(x),{icon:"Search",class:"absolute inset-y-0 right-0 w-4 h-4 my-auto mr-3"})])],2)]),a("div",Se,[o(be,{data:s.value,loading:h.value,totalRows:r.value,params:t,onChange:H,onToggleActive:K,onDeleteUser:ee,onEditUser:M},null,8,["data","loading","totalRows","params"])])]),o(ke,{showDialog:m.value,editBrand:d,onClose:b[2]||(b[2]=C=>m.value=!1),onUpdated:B},null,8,["showDialog","editBrand"]),o(n(N),{open:w.value,onClose:A},{default:f(()=>[o(n(N).Panel,null,{default:f(()=>[a("div",Ee,[o(n(x),{icon:"XCircle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),a("div",Ue,v(e.$t("brand.labels.areYouSure")),1),a("div",Ne,v(e.$t("brand.labels.deleteConfirmation")),1)]),a("div",Re,[o(n(D),{variant:"outline-secondary",type:"button",onClick:A,class:"w-24 mr-1"},{default:f(()=>[_(v(e.$t("brand.labels.cancel")),1)]),_:1}),o(n(D),{variant:"danger",type:"button",class:"ml-4 shadow-md w-28",onClick:te},{default:f(()=>[I.value?(p(),S(n(W),{key:0,icon:"three-dots",class:"w-5 h-5 text-white"})):(p(),y(q,{key:1},[_(v(e.$t("brand.labels.delete")),1)],64))]),_:1})])]),_:1})]),_:1},8,["open"]),o(n(ce),{id:"success-notification-content",class:"flex hidden"},{default:f(()=>[o(n(x),{icon:"CheckCircle",class:"text-success"}),a("div",je,[a("div",Ve,v(e.$t("brand.brandCreatedSuccess")),1),a("div",Ae,v(e.$t("brand.checkBrandListing")),1)])]),_:1})],64))}});export{Oe as default};
