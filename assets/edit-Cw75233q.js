import{U as Y,Q as Z,R as j,r as y,p as G,A as H,c as m,a as s,b as l,w as n,u as a,t as r,Y as h,F,h as J,X as K,a9 as ee,a2 as x,a3 as $,a5 as N,o as d,_,f as p,Z as te,e as g,I as D,g as S,i as se,N as P,D as B,a1 as ae,ag as V,ah as U,aa as oe}from"./index-iXE1tgq1.js";const le={class:"flex items-center mt-8 intro-y"},re={class:"mr-auto text-lg font-semibold"},ce={class:"grid grid-cols-12 gap-6 mt-5"},ne={class:"col-span-12 intro-y lg:col-span-12"},ie={class:"intro-y box p-8"},de={class:"grid grid-cols-12 gap-6"},ue={class:"col-span-12"},me={class:"flex items-center"},_e={key:0,class:"text-red-500 text-sm mt-2"},ge={class:"col-span-12"},ve={class:"flex items-center mb-4 w-[69%]"},ye={class:"border p-2 rounded-md min-h-[50px] w-[69%]"},pe={class:"m-3 font-semibold"},fe={class:"w-full flex items-center mb-4"},he={class:"flex items-center gap-2"},be={key:0,class:"mt-2 text-xs text-red-600"},Ce={key:0,class:"text-red-500 text-sm mt-2"},we={class:"col-span-12"},ke={class:"p-5 text-center"},xe={class:"mt-5 text-3xl"},$e={class:"mt-2 text-slate-500"},Se={class:"px-5 pb-8 text-center"},Ve={class:"ml-4 mr-4"},Ue={class:"font-medium"},Ie={class:"mt-1 text-slate-500"},Ne={__name:"edit",setup(Ee){const{t:I}=Y(),L=Z().getUserId,b=K(),W=b.params.uuid,A=j(new ee),u=y(!1),v=y("");let T=0;const c=y({user_id:L,name:"",sub_category:[],_method:"PUT"}),i=y({sub_category:""}),q=()=>{v.value.trim()!==""&&(c.value.sub_category.push({name:v.value.trim(),is_delete:0,parent_id:W,id:`temp-${T++}`}),v.value="",i.value.sub_category="")},O=()=>{let e=!0;return c.value.name.trim()?i.value.name="":(i.value.name=I("category.categoryNameRequired"),e=!1),C.value.length===0?(i.value.sub_category=I("category.addSubcategoryRequired"),e=!1):i.value.sub_category="",e},z=e=>{const o=typeof e=="number"?e:c.value.sub_category.findIndex(t=>t.id===e);if(o>-1){const t=c.value.sub_category[o];t.id&&!t.id.toString().startsWith("temp-")?t.is_delete=1:c.value.sub_category.splice(o,1)}},C=G(()=>c.value.sub_category.filter(e=>e.is_delete===0)),M=async()=>{if(C.value.length===0){i.value.sub_category="Please add at least one subcategory.";return}try{c.value.sub_category=c.value.sub_category.map(t=>({...t,id:t.id&&t.id.toString().startsWith("temp-")?null:t.id})),u.value=!0;const e=await x.category.edit(b.params.uuid,c.value),o=$(e);o.success&&(u.value=!1,V().fry(U.category.success(o.message)),oe.push("/inventory/categories"),w())}catch(e){A.setErrors(e.errors),V().fry(U.category.error(e.message)),u.value=!1,f.value=!1}},E=async()=>{try{u.value=!0;const e=await x.category.show(b.params.uuid),o=$(e);o.success&&(c.value.name=o.data.data.name,c.value.sub_category=o.data.data.sub_category.map(t=>({...t,is_delete:0}))),u.value=!1}catch(e){N(e),u.value=!1}};H(()=>{E()});const Q=async e=>{try{const o=await x.category.activation(e),t=$(o);t.success&&(V().fry(U.category.success(t.message)),getUsers())}catch(o){N(o)}},f=y(!1),X=()=>{O()&&(f.value=!0)},w=()=>{f.value=!1,E()};return(e,o)=>(d(),m(F,null,[s("div",le,[l(a(te),{to:"/inventory/categories"},{default:n(()=>[l(a(_),{variant:"primary",size:"sm",class:"shadow-md mr-4 h-8 w-9"},{default:n(()=>[l(a(p),{icon:"ChevronLeft",class:"w-5 h-5"})]),_:1})]),_:1}),s("h2",re,r(e.$t("category.editCategory")),1)]),s("div",ce,[s("div",ne,[s("div",ie,[s("div",de,[s("div",ue,[l(a(D),null,{default:n(()=>[g(r(e.$t("category.category")),1)]),_:1}),s("div",me,[l(a(S),{modelValue:c.value.name,"onUpdate:modelValue":o[0]||(o[0]=t=>c.value.name=t),id:"category",type:"text",class:"w-[60%]",placeholder:e.$t("category.category")},null,8,["modelValue","placeholder"])]),i.value.name?(d(),m("p",_e,r(i.value.name),1)):h("",!0)]),s("div",ge,[l(a(D),null,{default:n(()=>[g(r(e.$t("category.subCategory")),1)]),_:1}),s("div",ve,[l(a(S),{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=t=>v.value=t),id:"sub-category",type:"text",class:"w-[87%]",placeholder:e.$t("category.subCategory")},null,8,["modelValue","placeholder"]),l(a(_),{variant:"primary",class:"ml-4 shadow-md w-[100px] flex items-center pl-2 pr-4",onClick:q},{default:n(()=>[l(a(p),{icon:"Plus",class:"w-5 h-5 mr-2"}),s("p",null,r(e.$t("category.add")),1)]),_:1})]),s("div",ye,[s("h3",pe,r(e.$t("category.subCategories")),1),(d(!0),m(F,null,J(C.value,(t,R)=>(d(),m("div",{key:t.id||R,class:""},[s("div",fe,[l(a(S),{modelValue:t.name,"onUpdate:modelValue":k=>t.name=k,type:"text",class:"mr-4 w-[92%]",disabled:"disabled",placeholder:e.$t("category.enterSubcategory")},null,8,["modelValue","onUpdate:modelValue","placeholder"]),s("div",he,[l(a(_),{variant:"danger",class:"shadow-md flex items-center bg-red-500",onClick:k=>z(t.id||R)},{default:n(()=>[l(a(p),{icon:"Trash",class:"w-4 h-4"})]),_:2},1032,["onClick"]),t.id&&!t.id.toString().startsWith("temp-")?(d(),se(a(P),{key:0,class:"w-full mt-3 sm:w-auto sm:ml-auto sm:mt-0"},{default:n(()=>[l(a(P).Input,{onClick:k=>Q(t.id),checked:t.is_active,class:"ml-3 mr-0",type:"checkbox"},null,8,["onClick","checked"])]),_:2},1024)):h("",!0)])]),i.value.sub_category?(d(),m("div",be,r(i.value.sub_category),1)):h("",!0)]))),128))]),i.value.sub_category?(d(),m("p",Ce,r(i.value.sub_category),1)):h("",!0)]),s("div",we,[l(a(_),{variant:"primary",class:"mr-2 shadow-md w-28",onClick:X},{default:n(()=>[g(r(e.$t("category.submit")),1)]),_:1})])])])])]),l(a(B),{open:f.value,onClose:w},{default:n(()=>[l(a(B).Panel,null,{default:n(()=>[s("div",ke,[l(a(p),{icon:"CheckCircle",class:"w-16 h-16 mx-auto mt-3 text-success"}),s("div",xe,r(e.$t("category.deleteConfirmation")),1),s("div",$e,[g(r(e.$t("category.deleteWarning2")),1),o[2]||(o[2]=s("br",null,null,-1))])]),s("div",Se,[l(a(_),{variant:"outline-secondary",type:"button",onClick:w,class:"w-24 mr-1"},{default:n(()=>[g(r(e.$t("common.cancel")),1)]),_:1}),l(a(_),{variant:"primary",type:"button",class:"ml-4 w-24",onClick:M},{default:n(()=>[g(r(e.$t("common.save")),1)]),_:1})])]),_:1})]),_:1},8,["open"]),l(a(ae),{id:"success-notification-content",class:"flex hidden"},{default:n(()=>[l(a(p),{icon:"CheckCircle",class:"text-success"}),s("div",Ve,[s("div",Ue,r(e.$t("category.categoryCreatedSuccess")),1),s("div",Ie,r(e.$t("category.checkCategoryListing")),1)])]),_:1})],64))}};export{Ne as default};
