import{d as J,Q,r as u,R as X,U as Y,A as Z,V as G,c as R,a as t,t as d,b as o,w as l,u as s,n as I,F as H,W as K,o as f,i as N,e as g,_ as w,Y as $,Z as T,g as ee,f as y,$ as te,D as U,a1 as se,a2 as A,a3 as E,a4 as ae,a5 as L,ag as oe,ah as ce,O as le}from"./index-Do1w1vvF.js";const re={class:"mt-10 text-lg font-semibold intro-y"},ne={class:"grid grid-cols-12 gap-6 mt-5 intro-y box p-8"},ie={class:"col-span-12 flex justify-between"},de={class:"relative w-56 text-slate-500 mr-3"},ue={class:"flex w-[80px]",id:"fix"},ge=["onClick"],me=["checked"],_e={class:"flex gap-2.5"},ye=["onClick"],ve={class:"p-5 text-center"},pe={class:"mt-5 text-3xl"},he={class:"mt-2 text-slate-500"},fe={class:"px-5 pb-8 text-center"},Ce={class:"ml-4 mr-4"},be={class:"font-medium"},xe={class:"mt-1 text-slate-500"},ke=J({__name:"list",setup(we){const M=Q().getUserId,C=u(!0),S=u(0),c=X({page:1,limit:10,search:"",sort:"",sort_direction:"asc",paginate:!0,column_filters:[]}),{t:v}=Y(),D=u(null),z=u([{field:"category",title:v("category.heading")},{field:"sub_category",title:v("category.subCategories")},{field:"is_active",title:v("category.status"),sort:!1},{field:"actions",title:v("category.actions"),sort:!1}])||[],B=u(null);let p,V;const F=()=>{clearTimeout(V),V=setTimeout(()=>{m()},300)},m=async()=>{try{p&&p.abort(),p=new AbortController;const e=p.signal;C.value=!0;const a=(await K.get("https://inventory.jaldi.app/api/categories",{params:{...c,user_id:M,signal:e}})).data;D.value=a.data,S.value=a.meta.total}catch(e){console.error("Error fetching Stock Count:",e)}finally{C.value=!1}},q=e=>{c.page=e.current_page,c.limit=e.pagesize,c.sort=e.sort_direction==="desc"?`-${e.sort_column}`:`${e.sort_column}`,c.sort_direction=e.sort_direction,c.search=e.search,e.change_type==="search"?F():m()},_=u("en");Z(()=>{_.value=localStorage.getItem("locale")||"en",m()});const P=async e=>{var r;if(!(!e||!e.id))try{e.is_active=!e.is_active,console.log("row",e);const a=await A.category.activation(e.id),n=E(a);if(console.log("toggle",n),n.success){m();const i=(r=document.querySelector("#success-notification-content"))==null?void 0:r.cloneNode(!0);i&&(i.classList.remove("hidden"),i.querySelector(".font-medium").textContent="Category Status",i.querySelector(".text-slate-500").textContent=`${n.message}`,ae({node:i,duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0}).showToast())}else e.is_active=!e.is_active,console.error("Failed to toggle activation state")}catch(a){L(a),e.is_active=!e.is_active}},b=u(!1),x=u(null),W=e=>{x.value=e,b.value=!0},h=()=>{b.value=!1,x.value=null},j=e=>{W(e)},O=async()=>{try{const e=await A.category.delete(x.value);E(e).success&&(h(),m())}catch(e){L(e),h(),oe().fry(ce.category.error(e.message))}},k=G();return(e,r)=>(f(),R(H,null,[t("h2",re,d(e.$t("category.productsCategory")),1),t("div",ne,[t("div",ie,[t("div",null,[o(s(T),{to:"/inventory/categories/create"},{default:l(()=>[s(k).can("create","category")?(f(),N(s(w),{key:0,variant:"primary",class:"mr-2 shadow-md"},{default:l(()=>[g(d(e.$t("category.addNewCategory")),1)]),_:1})):$("",!0)]),_:1})]),t("div",{class:I(["flex items-center mt-3 sm:mt-0",{"mr-auto":_.value==="ar","ml-auto":_.value!=="ar"}])},[t("div",de,[o(s(ee),{modelValue:c.search,"onUpdate:modelValue":r[0]||(r[0]=a=>c.search=a),type:"text",class:"w-56 pr-10 !box",placeholder:e.$t("category.searchPlaceholder")},null,8,["modelValue","placeholder"]),o(s(y),{icon:"Search",class:"absolute inset-y-0 right-0 w-4 h-4 my-auto mr-3"})])],2)]),t("div",{class:I(["col-span-12",{"ar-all-category all-data-table-ar":_.value==="ar","":_.value!=="ar"}])},[o(s(te),{ref_key:"datatable",ref:B,rows:D.value,columns:s(z),loading:C.value,totalRows:S.value,isServerMode:!0,pageSize:c.limit,sortable:!0,sort:c.sort,sortDirection:c.sort_direction,search:c.search,onChange:q},{is_active:l(a=>[t("div",ue,[t("label",{class:"switch",onClick:n=>P(a.value.category)},[t("input",{type:"checkbox",checked:a.value.category.is_active},null,8,me),r[1]||(r[1]=t("span",{class:"slider round"},null,-1))],8,ge)])]),category:l(a=>{var n,i;return[g(d((i=(n=a.value)==null?void 0:n.category)==null?void 0:i.name),1)]}),sub_category:l(a=>{var n,i;return[g(d((i=(n=a.value)==null?void 0:n.sub_category)==null?void 0:i.name),1)]}),actions:l(a=>[t("div",_e,[s(k).can("delete","category")?(f(),R("a",{key:0,href:"#",class:"bg-red-100 p-2 rounded-md",onClick:n=>j(a.value.category.id)},[o(s(y),{icon:"Trash2",class:"w-4 h-4 text-[#cf2c47]"})],8,ye)):$("",!0),s(k).can("update","category")?(f(),N(s(T),{key:1,to:`/inventory/categories/${a.value.category.id}/edit`,class:"bg-blue-100 p-2 rounded-md cursor-pointer"},{default:l(()=>[o(s(y),{icon:"PencilLine",class:"w-4 h-4 text-blue-500"})]),_:2},1032,["to"])):$("",!0)])]),_:1},8,["rows","columns","loading","totalRows","pageSize","sort","sortDirection","search"])],2)]),o(s(U),{open:b.value,onClose:h},{default:l(()=>[o(s(U).Panel,null,{default:l(()=>[t("div",ve,[o(s(y),{icon:"XCircle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),t("div",pe,d(e.$t("category.deleteConfirmation")),1),t("div",he,[g(d(e.$t("category.deleteWarning"))+" ",1),r[2]||(r[2]=t("br",null,null,-1))])]),t("div",fe,[o(s(w),{variant:"outline-secondary",type:"button",onClick:h,class:"w-24 mr-1"},{default:l(()=>[g(d(e.$t("category.cancel")),1)]),_:1}),o(s(w),{variant:"danger",type:"button",class:"ml-4 w-24",onClick:O},{default:l(()=>[g(d(e.$t("category.delete")),1)]),_:1})])]),_:1})]),_:1},8,["open"]),o(s(se),{id:"success-notification-content",class:"flex hidden"},{default:l(()=>[o(s(y),{icon:"CheckCircle",class:"text-success"}),t("div",Ce,[t("div",be,d(e.$t("category.categoryCreatedSuccess")),1),t("div",xe,d(e.$t("category.checkCategoryListing")),1)])]),_:1})],64))}}),De=le(ke,[["__scopeId","data-v-de2ad828"]]);export{De as default};
