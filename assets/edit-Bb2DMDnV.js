import{Q as G,r as b,R as J,A as K,c as v,a,b as l,w as u,u as d,t as i,n as h,Y as f,F as P,h as F,X as W,a9 as X,a2 as q,a3 as C,a5 as S,aa as Y,x as E,o as p,_ as z,f as w,Z,e as m,I as g,g as y,ac as ee,J as ae,i as te,ad as se}from"./index-Do1w1vvF.js";import{_ as le}from"./index-qisK-D0y.js";import{_ as oe}from"./Dropzone.vue_vue_type_script_setup_true_lang-icQa-NwA.js";import"./dropzone-DWIWGpu4.js";const de={class:"flex items-center mt-8 intro-y"},re={class:"mr-auto text-lg font-semibold"},ie={class:"grid grid-cols-12 gap-6 mt-5"},ne={class:"col-span-12 intro-y lg:col-span-12"},ce={class:"intro-y box p-8"},ue={class:"grid grid-cols-12 gap-6"},pe={class:"col-span-6"},me={key:0,class:"mt-2 text-xs text-red-600"},ve={class:"col-span-6"},_e={key:0,class:"mt-2 text-xs text-red-600"},ge={class:"col-span-6"},fe={key:0,class:"mt-2 text-xs text-red-600"},ye={class:"col-span-6"},he={key:0,class:"mt-2 text-xs text-red-600"},be={class:"col-span-6"},Ve={class:"pt-7"},$e={class:"col-span-12"},ke={class:"grid grid-cols-12 gap-6 mt-5 relative z-10"},ze={class:"col-span-12 intro-y lg:col-span-12"},we={class:"intro-y box p-8"},xe={class:"grid grid-cols-12 gap-6"},Ue={class:"col-span-12"},Pe={class:"mr-auto text-lg font-medium -mb-1"},qe={class:"flex justify-center py-8"},Ce={class:"text-lg font-medium"},Se={class:"text-gray-600"},Ee={class:"col-span-12 -mt-4"},Re={key:0,class:"mt-2 text-xs text-red-600 font-medium"},De={class:"grid grid-cols-12 gap-6 mt-5"},Fe={class:"col-span-12 intro-y lg:col-span-12"},Ae={class:"intro-y box p-8"},Me={class:"grid grid-cols-12 gap-6"},Ne={class:"col-span-12"},Be={class:"mr-auto text-lg font-medium -mb-1"},je={class:"col-span-12"},Ie={class:"gap-5"},Le={class:"grid grid-cols-12 gap-6"},Te={class:"sm:col-span-3 md:col-span-3 lg:col-span-2"},Oe={key:0,class:"mt-2 text-xs text-red-600"},He={class:"sm:col-span-3 md:col-span-3 lg:col-span-2"},Qe={key:0,class:"mt-2 text-xs text-red-600"},Ge={class:"sm:col-span-3 md:col-span-3 lg:col-span-2"},Je={key:0,class:"mt-2 text-xs text-red-600"},Ke={class:"sm:col-span-3 md:col-span-3 lg:col-span-2 relative"},We={class:"flex items-center z-40"},Xe=["value","selected"],Ye={class:"grid grid-cols-12 gap-6 mt-5 relative z-[10]"},Ze={class:"col-span-12 intro-y lg:col-span-12"},ea={class:"intro-y box p-8"},aa={class:"grid grid-cols-12 gap-6"},ta={class:"col-span-12"},sa={class:"mr-auto text-lg font-medium -mb-1"},la={class:"col-span-12"},oa={class:"gap-5"},da={key:0,class:"col-span-2"},ra={key:1,class:"col-span-2"},ia={class:"col-span-2 relative"},na={key:0,class:"mt-1 absolute text-xs text-red-600"},ca={class:"col-span-2"},ua={class:"col-span-2"},pa={class:"col-span-2 ml-2 gap-2 items-center mt-7"},ma={class:"col-span-12"},va={key:0,class:"fixed top-0 w-full h-full left-0 flex items-center justify-center bg-black bg-opacity-30 z-[999999]"},Va={__name:"edit",setup(_a){const A=G().getUserId,R=W(),o=b({user_id:A,brand_id:"",category_id:"",sub_category_id:"",SubCategorySelect:"",sku:"",image:"",name_ar:"",name_en:"",barcode:"",description:"",initial_quantity:"",cost_price:"",sale_price:"",vat:" ",packings:[],_method:"PUT"}),M=b(),N=[{value:1,label:"Subject to VAT"},{value:0,label:"Subject to no VAT"}],n=J(new X),$=b(!1),B=async()=>{var e,s,t;try{$.value=!0;const _=await q.product.show(R.params.uuid),r=C(_);if(console.log("Product details fetched:",r),r.success){o.value={...o.value,barcode:r.data.data.barcode,category_id:((e=r.data.data.category)==null?void 0:e.id)||"",sub_category_id:((s=r.data.data.sub_category)==null?void 0:s.id)||"",SubCategorySelect:((t=r.data.data.sub_category)==null?void 0:t.id)||"",sku:r.data.data.sku,name_ar:r.data.data.name_ar,name_en:r.data.data.name_en,description:r.data.data.description,initial_quantity:r.data.data.initial_quantity,cost_price:r.data.data.cost_price,sale_price:r.data.data.sale_price,packings:r.data.data.packings,brand_id:r.data.data.brand_id,image:r.data.data.image,vat:r.data.data.vat?1:0};const c=U.value;if(c&&r.data.data.image){const k={name:"Existing Image",size:123456};c.dropzone.emit("addedfile",k),c.dropzone.emit("thumbnail",k,r.data.data.image),c.dropzone.files.push(k)}await I(r.data.data.packings)}}catch(_){S(_)}finally{$.value=!1,console.log("Loading state set to false")}},j=async()=>{try{$.value=!0,o.value.category_id=o.value.category_id,o.value.sub_category_id=o.value.SubCategorySelect,o.value.packings=o.value.packings.filter(t=>t.type==="Custom"||t.type==="Outer"||t.type==="Carton"?t.qty&&t.barcode&&t.sale_price:!0),console.log(o.value);const e=await q.product.edit(R.params.uuid,o.value);C(e).success&&($.value=!1,Y.push("/inventory/products"))}catch(e){S(e),$.value=!1,n.setErrors(e.errors)}},V=b([]),x=b(),I=async e=>{try{const s=await q.packings.list(),t=C(s);if(t.success){x.value=t.data.data;const _=t.data.data.map(c=>({id:c.id,type:c.name||"",label:c.label||"",barcode:c.barcode||"",qty:c.quantity||0,sale_price:c.sale_price||0,vat:c.vat||15,isCustom:!1})),r=[...e,..._.filter(c=>!e.find(k=>k.id===c.id))];o.value.packings=r,o.value.packings=o.value.packings.filter(c=>c.type==="Custom"?c.qty&&c.barcode&&c.sale_price:!0),V.value=r,V.value=V.value.filter(c=>c.type==="Custom"?c.qty&&c.barcode&&c.sale_price:!0)}}catch(s){S(s)}},D=b(!1),L=()=>{const e={id:x.value[2].id,type:x.value[2].name,label:"",barcode:"",qty:0,sale_price:0,vat:1,isCustom:!0};V.value.push(e),o.value.packings=[...V.value],D.value=!0},T=e=>{V.value.length>2&&(V.value.splice(e,1),o.value.packings=[...V.value])},O=()=>{o.value.sku=Math.floor(1e10+Math.random()*9e10).toString()};K(()=>{B();const e=U.value;e&&(e.dropzone.on("addedfile",s=>{o.value.image=s}),e.dropzone.on("removedfile",()=>{o.value.image=""}))});const H=b(),U=b(),Q=b();return E("bind[dropzoneSingleRef]",e=>{H.value=e}),E("bind[dropzoneMultipleRef]",e=>{U.value=e}),E("bind[dropzoneValidationRef]",e=>{Q.value=e}),(e,s)=>(p(),v(P,null,[a("div",de,[l(d(Z),{to:"/inventory/products"},{default:u(()=>[l(d(z),{variant:"primary",size:"sm",class:"shadow-md mr-4 h-8 w-9"},{default:u(()=>[l(d(w),{icon:"ChevronLeft",class:"w-5 h-5"})]),_:1})]),_:1}),a("h2",re,i(e.$t("product.editProduct")),1)]),a("div",ie,[a("div",ne,[a("div",ce,[a("div",ue,[a("div",pe,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.barcode"))+" ",1),s[9]||(s[9]=a("span",{class:"text-danger"}," *",-1))]),_:1}),l(d(y),{modelValue:o.value.barcode,"onUpdate:modelValue":s[0]||(s[0]=t=>o.value.barcode=t),id:"barcode-1",type:"text",placeholder:e.$t("product.scanOrEnterBarcode"),class:h({"border-red-500":n.invalid("barcode")})},null,8,["modelValue","placeholder","class"]),n.invalid("barcode")?(p(),v("div",me,i(n.getError("barcode")),1)):f("",!0)]),s[13]||(s[13]=a("div",{class:"col-span-6"},null,-1)),a("div",ve,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.productNameEn"))+" ",1),s[10]||(s[10]=a("span",{class:"text-danger"}," *",-1))]),_:1}),l(d(y),{modelValue:o.value.name_en,"onUpdate:modelValue":s[1]||(s[1]=t=>o.value.name_en=t),id:"name_en",type:"text",placeholder:e.$t("product.productNameEn"),class:h({"border-red-500":n.invalid("name_en")})},null,8,["modelValue","placeholder","class"]),n.invalid("name_en")?(p(),v("div",_e,i(n.getError("name_en")),1)):f("",!0)]),a("div",ge,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.productNameAr"))+" ",1),s[11]||(s[11]=a("span",{class:"text-danger"}," *",-1))]),_:1}),l(d(y),{id:"nameAr",modelValue:o.value.name_ar,"onUpdate:modelValue":s[2]||(s[2]=t=>o.value.name_ar=t),type:"text",placeholder:e.$t("product.productNameAr"),class:h({"border-red-500":n.invalid("name_ar")})},null,8,["modelValue","placeholder","class"]),n.invalid("name_ar")?(p(),v("div",fe,i(n.getError("name_ar")),1)):f("",!0)]),a("div",ye,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.sku"))+" ",1),s[12]||(s[12]=a("span",{class:"text-danger"}," *",-1))]),_:1}),l(d(y),{modelValue:o.value.sku,"onUpdate:modelValue":s[3]||(s[3]=t=>o.value.sku=t),id:"sku",type:"text",placeholder:e.$t("product.sku"),class:h({"border-red-500":n.invalid("sku")})},null,8,["modelValue","placeholder","class"]),n.invalid("sku")?(p(),v("div",he,i(n.getError("sku")),1)):f("",!0)]),a("div",be,[a("div",Ve,[l(d(z),{variant:"primary",class:"mr-2 py-2 w-[180px] shadow-md",onClick:O},{default:u(()=>[m(i(e.$t("product.autoGenerateSku")),1)]),_:1})])]),a("div",$e,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.description")),1)]),_:1}),l(d(ee),{modelValue:o.value.description,"onUpdate:modelValue":s[4]||(s[4]=t=>o.value.description=t),class:"py-2 pl-4 resize-none",rows:3,placeholder:e.$t("product.description")},null,8,["modelValue","placeholder"])])])])])]),l(le,{createFormData:o.value,isProductBankData:M.value,form:n},null,8,["createFormData","isProductBankData","form"]),a("div",ke,[a("div",ze,[a("div",we,[a("div",xe,[a("div",Ue,[a("h3",Pe,i(e.$t("product.uploadImage")),1)]),a("div",{class:h(["col-span-12 upload-img",{"border-upload":n.invalid("image")}])},[l(d(oe),{refKey:"dropzoneMultipleRef",options:{url:"https://httpbin.org/post",autoProcessQueue:!1,thumbnailWidth:150,maxFilesize:100,acceptedFiles:"image/jpeg,image/png,image/jpg",headers:{"My-Awesome-Header":"header value"},addRemoveLinks:!0},class:"dropzone"},{default:u(()=>[a("div",qe,[l(d(w),{icon:"Upload",class:"w-10 h-10"})]),a("div",Ce,i(e.$t("product.dropFilesHere")),1),a("div",Se,i(e.$t("product.selectedFiles")),1)]),_:1})],2),a("div",Ee,[n.invalid("image")?(p(),v("div",Re,i(e.$t("product.imageUploadError")),1)):f("",!0)])])])])]),a("div",De,[a("div",Fe,[a("div",Ae,[a("div",Me,[a("div",Ne,[a("h3",Be,i(e.$t("product.stockAndPricingDetails")),1)]),a("div",je,[a("div",Ie,[a("div",Le,[a("div",Te,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.quantity")),1)]),_:1}),l(d(y),{min:"0",modelValue:o.value.initial_quantity,"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.initial_quantity=t),disabled:"",type:"text",placeholder:"0",class:h({"border-red-500":n.invalid("initial_quantity")})},null,8,["modelValue","class"]),n.invalid("initial_quantity")?(p(),v("div",Oe,i(n.getError("initial_quantity")),1)):f("",!0)]),a("div",He,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.costPrice"))+" ",1),s[14]||(s[14]=a("span",{class:"text-danger"}," *",-1))]),_:1}),l(d(y),{id:"barcode-",disabled:"",modelValue:o.value.cost_price,"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.cost_price=t),type:"text",placeholder:"0.00",class:h({"border-red-500":n.invalid("cost_price")})},null,8,["modelValue","class"]),n.invalid("cost_price")?(p(),v("div",Qe,i(n.getError("cost_price")),1)):f("",!0)]),a("div",Ge,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.salePrice"))+" ",1),s[15]||(s[15]=a("span",{class:"text-danger"}," *",-1))]),_:1}),l(d(y),{id:"qty-",modelValue:o.value.sale_price,"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.sale_price=t),type:"number",placeholder:"0.00",class:h({"border-red-500":n.invalid("sale_price")})},null,8,["modelValue","class"]),n.invalid("sale_price")?(p(),v("div",Je,i(n.getError("sale_price")),1)):f("",!0)]),a("div",Ke,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.vat"))+" ",1),s[16]||(s[16]=a("span",{class:"text-danger"}," *",-1))]),_:1}),a("div",We,[l(d(ae),{modelValue:o.value.vat,"onUpdate:modelValue":s[8]||(s[8]=t=>o.value.vat=t),options:{placeholder:e.$t("product.vat")},class:"w-full z-40"},{default:u(()=>[s[17]||(s[17]=a("option",{value:""},null,-1)),(p(),v(P,null,F(N,t=>a("option",{key:t.value,value:t.value,selected:o.value.vat===t.value},i(t.label),9,Xe)),64))]),_:1},8,["modelValue","options"])])])])])])])])])]),a("div",Ye,[a("div",Ze,[a("div",ea,[a("div",aa,[a("div",ta,[a("h3",sa,i(e.$t("product.packings")),1)]),a("div",la,[a("div",oa,[(p(!0),v(P,null,F(o.value.packings,(t,_)=>(p(),v("div",{key:_,class:h({"new-packing-class":D.value})},[a("div",{class:h(`pb-6 grid grid-cols-12 gap-2 items-center hi${_}`)},[_<2?(p(),v("div",da,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.packagingName")),1)]),_:1}),l(d(y),{modelValue:t.type,"onUpdate:modelValue":r=>t.type=r,type:"text",placeholder:e.$t("product.packagingType"),disabled:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])])):f("",!0),_>1?(p(),v("div",ra,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.label")),1)]),_:1}),l(d(y),{modelValue:t.label,"onUpdate:modelValue":r=>t.label=r,type:"text",placeholder:e.$t("product.label")},null,8,["modelValue","onUpdate:modelValue","placeholder"])])):f("",!0),a("div",ia,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.barcode")),1)]),_:1}),l(d(y),{modelValue:t.barcode,"onUpdate:modelValue":r=>t.barcode=r,type:"text",placeholder:e.$t("product.barcode"),class:h({"border-red-500":n.invalid(`packings.${_}.barcode`)})},null,8,["modelValue","onUpdate:modelValue","placeholder","class"]),n.invalid(`packings.${_}.barcode`)?(p(),v("div",na,i(e.$t("product.barcodeError")),1)):f("",!0)]),a("div",ca,[l(d(g),{class:"capitalize"},{default:u(()=>[m(i(_>1?e.$t("product.piecesInPacking"):`${e.$t("product.quantityIn")} ${t.type}`),1)]),_:2},1024),l(d(y),{modelValue:t.qty,"onUpdate:modelValue":r=>t.qty=r,type:"number",placeholder:e.$t("product.quantity")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),a("div",ua,[l(d(g),null,{default:u(()=>[m(i(e.$t("product.salePrice")),1)]),_:1}),l(d(y),{modelValue:t.sale_price,"onUpdate:modelValue":r=>t.sale_price=r,type:"number",placeholder:e.$t("product.salePrice")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),a("div",pa,[_>1?(p(),te(d(z),{key:0,variant:"danger",class:"shadow-md flex items-center",onClick:r=>T(_)},{default:u(()=>[l(d(w),{icon:"Trash",class:"w-5 h-5"})]),_:2},1032,["onClick"])):f("",!0)])],2)],2))),128)),l(d(z),{variant:"primary",class:"shadow-md flex items-center",onClick:L},{default:u(()=>[l(d(w),{icon:"Plus",class:"w-5 h-5"}),m(" "+i(e.$t("product.addCustomPacking")),1)]),_:1})])]),a("div",ma,[l(d(z),{variant:"primary",class:"mr-2 shadow-md",onClick:j},{default:u(()=>[m(i(e.$t("product.save")),1)]),_:1})])])])])]),$.value?(p(),v("div",va,[l(se,{class:"absolute flex items-center justify-center w-full h-full top-0",margin:"0px",loading:!0,color:"#fff",size:"50px"})])):f("",!0)],64))}};export{Va as default};
