import{d as D,Q as N,r as u,R as U,U as A,A as B,V as E,c as x,a,t as h,u as o,i as f,w as n,Y as d,b as r,F as I,W as z,o as c,e as T,_ as j,Z as g,g as F,f as v,$ as L}from"./index-Do1w1vvF.js";const M={class:"mt-10 text-lg font-semibold intro-y"},P={class:"grid grid-cols-12 gap-6 mt-5 intro-y box p-8"},J={class:"col-span-12 flex justify-between intro-y"},Q={class:"flex items-center mt-3 sm:ml-auto sm:mt-0"},W={class:"relative w-56 text-slate-500 mr-3"},Y={class:"col-span-12"},Z={class:"flex items-center gap-4"},q={key:0,class:"bg-yellow-100 text-yellow-800 text-xs font-medium me-2 px-2.5 py-1 rounded dark:bg-yellow-900 dark:text-yellow-300"},G={class:"flex gap-2.5"},X=D({__name:"list",setup(H){const S=N().getUserId,m=u(!1),y=u(0),k=u([]),$=u(null),e=U({page:1,limit:10,search:"",sort:"-count_date",sort_direction:"desc",paginate:!0,column_filters:[]}),{t:l}=A(),C=[{field:"count_name",title:l("stock-count.countName")},{field:"count_date",title:l("stock-count.countDate")},{field:"notes",title:l("stock-count.notes")},{field:"actions",title:l("stock-count.actions"),sort:!1,with:" 25%"}];let i,w;const V=()=>{clearTimeout(w),w=setTimeout(()=>{_()},300)},_=async()=>{try{i&&i.abort(),i=new AbortController;const t=i.signal;m.value=!0;const s=(await z.get("https://inventory.jaldi.app/api/stock-counts",{params:{...e,user_id:S,signal:t}})).data;k.value=s.data,y.value=s.meta.total,$.value=s.meta.open_register_id||""}catch(t){console.error("Error fetching Stock Count:",t)}finally{m.value=!1}},R=t=>{e.page=t.current_page,e.limit=t.pagesize,e.sort=t.sort_direction==="desc"?`-${t.sort_column}`:`${t.sort_column}`,e.sort_direction=t.sort_direction,e.search=t.search,t.change_type==="search"?V():_()};B(_);const b=E();return(t,p)=>(c(),x(I,null,[a("h2",M,h(t.$t("stock-count.heading")),1),a("div",P,[a("div",J,[a("div",null,[o(b).can("create","stockCount")?(c(),f(o(g),{key:0,to:"/inventory/stock-count/create"},{default:n(()=>[r(o(j),{variant:"primary",class:"mr-2 shadow-md"},{default:n(()=>[T(h(t.$t("stock-count.createNew")),1)]),_:1})]),_:1})):d("",!0)]),a("div",Q,[a("div",W,[o(b).can("list","stockCount")?(c(),f(o(F),{key:0,modelValue:e.search,"onUpdate:modelValue":p[0]||(p[0]=s=>e.search=s),type:"text",class:"w-56 pr-10 !box",placeholder:t.$t("stock-count.searchPlaceholder")},null,8,["modelValue","placeholder"])):d("",!0),r(o(v),{icon:"Search",class:"absolute inset-y-0 right-0 w-4 h-4 my-auto mr-3"})])])]),a("div",Y,[r(o(L),{rows:k.value,columns:C,loading:m.value,totalRows:y.value,isServerMode:!0,pageSize:e.limit,sortable:!0,sort:e.sort,sortDirection:e.sort_direction,search:e.search,onChange:R},{count_name:n(s=>[a("div",Z,[a("p",null,h(s.value.count_name),1),s.value.is_draft===1?(c(),x("span",q," Draft")):d("",!0)])]),actions:n(s=>[a("div",G,[r(o(g),{to:`/inventory/stock-count/${s.value.id}`,class:"bg-[#96837f33] p-2 rounded-md cursor-pointer"},{default:n(()=>[r(o(v),{icon:"Eye",class:"w-4 h-4 text-gray-600"})]),_:2},1032,["to"]),s.value.is_draft===1?(c(),f(o(g),{key:0,to:`/inventory/stock-count/${s.value.id}/edit`,class:"bg-blue-100 p-2 rounded-md cursor-pointer"},{default:n(()=>[r(o(v),{icon:"PencilLine",class:"w-4 h-4 text-blue-500"})]),_:2},1032,["to"])):d("",!0)])]),_:1},8,["rows","loading","totalRows","pageSize","sort","sortDirection","search"])])])],64))}});export{X as default};
